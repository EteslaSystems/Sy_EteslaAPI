DELIMITER //
CREATE OR REPLACE PROCEDURE SP_Viaticos
(
	IN Opcion INT,
	IN xIdViatico VARCHAR(255),
	IN NombreViatico VARCHAR(80),
    IN TipoDeMoneda VARCHAR(8),
	IN Valor FLOAT
)
BEGIN
	/*Insertar*/
	IF(Opcion = 0) THEN	
	   INSERT INTO viaticos
	   VALUES(UUID(), NombreViatico, TipoDeMoneda, Valor, NOW(), NULL, NULL);
    /*Eliminar*/
	ELSEIF(Opcion = 1) THEN
	   UPDATE viaticos
	   SET deleted_at = NOW()
	   WHERE idViatico = UNHEX(xIdViatico);
    /*Actualizar*/
	ELSEIF(Opcion = 2) THEN
	   UPDATE viaticos
	   SET vNombreViatico = NombreViatico, vTipoMoneda = TipoDeMoneda, fValor = Valor, updated_at = NOW()
	   WHERE idViatico = UNHEX(xIdViatico);
	/*Leer*/
    ELSEIF(Opcion = 3) THEN
	   SELECT HEX(idViatico) AS idViatico, vNombreViatico, fValor, created_at, updated_at, deleted_at
	   FROM viaticos
	   WHERE deleted_at IS NULL
	   ORDER BY created_at DESC;
    /*Leer - filtrado*/
	ELSEIF(Opcion = 4) THEN
	   SELECT HEX(idViatico) AS idViatico, vNombreViatico, fValor, created_at, updated_at, deleted_at
	   FROM viaticos
	   WHERE idViatico = UNHEX(xIdViatico);
	END IF;
END
// DELIMITER;