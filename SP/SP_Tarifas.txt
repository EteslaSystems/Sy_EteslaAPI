DELIMITER //
CREATE OR REPLACE PROCEDURE SP_Tarifas
(
	IN Opcion INT,
	IN xIdTarifa VARCHAR(255),
	IN xIdTarifaCobro VARCHAR(255),
	IN NombreTarifa CHAR(7),
	IN TipoCotizacion CHAR(15),
	IN Periodo CHAR(10),
	IN LimiteKw SMALLINT(6),
	IN ObjetivoDAC SMALLINT(6),
	IN TarifaComercial TINYINT(1),
	IN Nivel TINYINT(4),
	IN Rango TINYINT(4),
	IN Precio FLOAT
)
BEGIN
	IF(Opcion = 3) THEN
	/*Leer*/
	   	SELECT HEX(tar.idTarifa) AS idTarifa, tar.cNombre, tar.siLimiteKw, tar.siObjetivoDAC, tar.created_at AS tar_created_at, tar.updated_at AS tar_updated_at, tc.tiNivel, tc.tiRango, tc.fPrecio, tc.created_at AS tc_created_at, tc.updated_at AS tc_updated_at
		FROM tarifa tar
		INNER JOIN tarifa_cobro tc
		ON tc.id_Tarifa = tar.idTarifa
		WHERE tar.deleted_at IS NULL;
	ELSEIF(Opcion = 4) THEN
	/*Leer - filtrado*/
		SELECT HEX(tar.idTarifa) AS idTarifa, tar.cNombre, tar.siLimiteKw, tar.siObjetivoDAC, tar.created_at AS tar_created_at, tar.updated_at AS tar_updated_at, tc.tiNivel, tc.tiRango, tc.fPrecio, tc.created_at AS tc_created_at, tc.updated_at AS tc_updated_at
		FROM tarifa tar
		INNER JOIN tarifa_cobro tc
		ON tc.id_Tarifa = tar.idTarifa
		WHERE tar.deleted_at IS NULL
		AND tar.idTarifa = UNHEX(xIdTarifa);
	END IF;
END
// DELIMITER ;
